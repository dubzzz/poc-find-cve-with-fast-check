// https://security.snyk.io/vuln/SNYK-JS-LODASH-450202
const _ = require('lodash-4.17.11');

const { test } = require('@jest/globals');
const fc = require('fast-check');
const { assertNoPoisoning, restoreGlobals } = require('@fast-check/poisoning');

fc.configureGlobal({ afterEach: restoreGlobals });

test('CVE-2019-10744', () => {
  fc.assert(
    fc.property(fc.object(), fc.object(), (raw, other) => {
      // Arrange
      const instance = _.cloneDeep(raw); // just not to alter the original object

      // Act
      _.defaultsDeep(instance, other);

      // Assert
      assertNoPoisoning();
    }),
    { seed: 21491697 }
  );
});
// { seed: 21491697, path: "49:0:1:68:67:67:67:68:68", endOnFailure: true }
