// https://security.snyk.io/vuln/SNYK-JS-LODASH-608086
const _ = require('lodash-4.17.16');

const { test } = require('@jest/globals');
const fc = require('fast-check');
const { assertNoPoisoning, restoreGlobals } = require('@fast-check/poisoning');

fc.configureGlobal({ afterEach: restoreGlobals });

const pathArbitrary = fc
  .array(fc.string(), { minLength: 1 })
  .map((pathItems) => pathItems.map((item) => `[${item}]`).join(''));

test('SNYK-JS-LODASH-608086', () => {
  fc.assert(
    fc.property(fc.object(), pathArbitrary, fc.anything(), (raw, path, value) => {
      // Arrange
      const instance = _.cloneDeep(raw); // just not to alter the original object

      // Act
      _.setWith(instance, path, value);

      // Assert
      assertNoPoisoning();
    })
  );
});
// { seed: -1537998486, path: "14:0:1:66:66:66", endOnFailure: true }
